<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Internal Structures - ARC RDF Classes for PHP</title>
    <style type="text/css" media="all">
     @import url("/code/trice/trice.css?d=3");
     @import url("/themes/arc_2007/theme.css?d=3");
    </style>
    
    <script type="text/javascript" src="/code/trice/wiki/wiki.js?d=3"></script>
    <script type="text/javascript" src="/code/trice/stats/stats.js?d=3"></script>
    <script type="text/javascript" src="/themes/arc_2007/theme.js?d=3"></script>
    <script type="text/javascript" src="/code/trice/dom.js?d=3"></script>
    <script type="text/javascript" src="/code/trice/trice.js?d=3"></script>
    <script type="text/javascript">
      <!--
      var root_path = '/';
      var request_method = 'get';
      //-->
    </script>
  </head>
  <body>
    <div class="page">

  <div class="sysnavbar">
    <ul><li><a href="/login">log in</a></li><li><a href="/imprint">imprint</a></li></ul>  </div>
  
  <div class="applogo">
    <a href="/"><img src="/themes/arc_2007/logo.gif" alt="ARC" /></a>
  </div>

  <div class="header">

    <div class="topnavbar">
      <ul><li><a href="/home">Home</a></li><li><a href="/features">Features</a></li><li><a href="/docs">Documentation</a></li><li><a href="/community">Community</a></li><li><a href="/download">Download</a></li><li><a href="/dev">Development</a></li><li><a href="/sites">Sites</a></li></ul>
    </div>
  
  </div>

  <div class="canvas">
    <div class="title"><h1>Internal Structures</h1></div>
    <div class="content">
      
      <div  class="w65 fl">
        ARC uses object-oriented code for its components and methods, but the processed data structures consist of simple associative arrays, which leads to faster operations and less memory consumption. Apart from a few special formats returned by the SPARQL engine (e.g. from SELECT or INSERT queries), ARC is built around two core structures: triple sets and resource indexes. <br />
 <br />
<strong>Note:</strong> ARC's structures were recently (May/June 2008) aligned with the <a href="http://www.talis.com/platform/">Talis platform</a>, earlier versions used "iri", "dt", and "val" instead of "uri", "datatype", and "value". There were also multiple literal types (e.g. "literal_long1") which are now simplified to just "literal".<br />
<div class="hr"><hr /></div>
<h2>Triple sets</h2>
A triple set is a flat array that contains (associative) triple arrays. Triple sets can be processed with a simple loop:<br />

      <div class="code w95"><pre class="code">...
$triples = $parser-&gt;getTriples();
for ($i = 0, $i_max = count($triples); $i &lt; $i_max; $i++) {
  $triple = $triples[$i];
  ...
}</pre></div>
    
 
 <br />
A single triple array can contain the following keys:<br />
<dl><dt>s</dt>
<dd>the subject value (a URI, Bnode ID, or Variable)
</dd>
<dt>p</dt>
<dd>the property URI (or a Variable)
</dd>
<dt>o</dt>
<dd>the subject value (a URI, Bnode ID, Literal, or Variable)
</dd>
<dt>s_type</dt>
<dd>"uri", "bnode", or "var"
</dd>
<dt>o_type</dt>
<dd>"uri", "bnode", "literal", or "var"
</dd>
<dt>o_datatype</dt>
<dd>a datatype URI
</dd>
<dt>o_lang</dt>
<dd>a language identifier, e.g. ("en-us")<br />
</dd></dl>
 
Variables are generated by ARC's Turtle parser which was implemented for the SPARQL processor and therefore extends the <a href="http://www.dajobe.org/2004/01/turtle/">Turtle spec</a> with support for features such as single quotes around literals, and variables. The latter lead to a handy by-product which can be used for <a href="/docs/v2/misc/turtle_templates">dynamic graph creation</a>.<br />
 <br />
<div class="hr"><hr /></div>
<h2>Resource Indexes</h2>
A resource index is an associative array of triples indexed by subject -> predicates -> objects. <br />

      <div class="code w95"><pre class="code">$index = array(
  '_:john' =&gt; array(
    'http://xmlns.com/foaf/0.1/knows' =&gt; array(
      '_:bill',
      '_:bob',
      '_:mary',
    ),
  ),
  '_:mary' =&gt; ...
);

echo $index['_:john']['http://xmlns.com/foaf/0.1/knows'][0];</pre></div>
    

ARC supports two index forms. The one above uses flat objects, which can be handy for simplified access operations, but can lead to information loss (e.g. when the object type is not clear, or when a datatype was present in the original triples). The second, slightly extended index structure keeps the object details:<br />


      <div class="code w95"><pre class="code">$index = array(
  '_:john' =&gt; array(
    'http://xmlns.com/foaf/0.1/knows' =&gt; array(
      array('value' =&gt; '_:bill', 'type' =&gt; 'bnode'),
      array('value' =&gt; '_:bob', 'type' =&gt; 'bnode'),
      ...
    ),
  ),
);

echo $index['_:john']['http://xmlns.com/foaf/0.1/knows'][0]['value'];</pre></div>
    
This form is also returned by the DESCRIBE and CONSTRUCT query handlers.<br />
<div class="hr"><hr /></div>
<h2>Index and Triple Operations</h2>
ARC provides a number of operations for PHP arrays compatible with the structures described above, e.g.<br />

      <div class="code w95"><pre class="code">$triples = $parser-&gt;getTriples();
$turtle_doc = $parser-&gt;toTurtle($triples);
$json_doc = $parser-&gt;toRDFJSON($triples);

$index = ARC2::getSimpleIndex($triples, false) ; /* false -&gt; non-flat version */
$rdfxml_doc = $parser-&gt;toRDFXML($index);

$triples = ARC2::getTriplesFromIndex($index);

$merged_index = ARC2::getMergedIndex($index1, $index2, $index3);</pre></div>
    
      </div>
    


      <div  class="w30 fr">
        

      <div class="box">
        <h3><a href="/docs">Documentation</a></h3>
<ul><li><a href="/docs/v2/intro">Introducing ARC2</a></li><li><a href="/docs/v2/getting_started">Getting Started</a></li><li><a href="/docs/v2/structures">Internal Structures</a></li><li><a href="/docs/v2/parsing">Parsing RDF</a></li><li><a href="/docs/v2/store">Using the RDF Store</a></li><li><a href="/docs/v2/endpoint">SPARQL Endpoint Setup</a></li><li><a href="/docs/v2/serializing">Serializing ARC structures</a></li><li><a href="/docs/v2/extractors">Extracting RDF from HTML</a></li><li><a href="/docs/v2/remote_stores">Remote Stores/Endpoints</a></li><li><a href="/docs/v2/sparql+">SPARQL+</a></li><li><a href="/docs/v2/sparqlscript">SPARQLScript</a></li><li><a href="/docs/v2/sparql_extension_functions">SPARQL Extension Functions</a></li></ul>


      </div>
    
      </div>
          <div class="clb"></div>
    </div>
  </div>
  
  <div class="footer">
    <p>Last modified: 2008-07-01 12:49:13 UTC</p><p>Powered by <a href="http://trice.semsol.org/" title="Version: 2007-11-13">Trice</a> Wiki Module</p>  </div>
    
</div>

  </body>
</html>